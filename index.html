<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>College Hockey Player Cards</title>
<link href="https://fonts.googleapis.com/css2?family=Barlow+Condensed:ital,wght@0,400;0,600;0,700;0,800;1,700;1,800&family=Oswald:wght@500;700&display=swap" rel="stylesheet"/>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
<style>
*{box-sizing:border-box;margin:0;padding:0;}
body{background:#1a1a2e;min-height:100vh;font-family:'Barlow Condensed',sans-serif;color:#e2e8f0;display:flex;flex-direction:column;align-items:center;padding:30px 16px;}

/* ‚îÄ‚îÄ Page title ‚îÄ‚îÄ */
.page-title{width:100%;max-width:700px;margin-bottom:16px;display:flex;align-items:center;gap:10px;}
.page-title .bar{width:5px;height:32px;background:#c8102e;border-radius:3px;}
.page-title h1{font-size:24px;font-weight:800;letter-spacing:.08em;color:#fff;}
.page-title span{font-size:11px;color:#666;letter-spacing:.12em;text-transform:uppercase;display:block;}

/* ‚îÄ‚îÄ Dropdown row ‚îÄ‚îÄ */
.dropdown-row{width:100%;max-width:700px;margin-bottom:20px;position:relative;}
.dropdown-row select{
  width:100%;padding:11px 16px;
  background:#111827;border:1px solid #2d3748;border-radius:8px;
  color:#fff;font-size:14px;font-family:inherit;outline:none;cursor:pointer;
  appearance:none;-webkit-appearance:none;
}
.dropdown-row::after{content:"‚ñæ";position:absolute;right:14px;top:50%;transform:translateY(-50%);color:#888;pointer-events:none;font-size:16px;}

/* ‚îÄ‚îÄ Card shell ‚îÄ‚îÄ */
.card{width:100%;max-width:700px;display:none;}
.card-wrap{background:linear-gradient(160deg,#0f1923 0%,#0a1628 100%);border-radius:10px;border:1px solid #1e3a5f;overflow:hidden;box-shadow:0 8px 40px rgba(0,0,0,.7);}

/* ‚îÄ‚îÄ Card top banner ‚îÄ‚îÄ */
.card-banner{background:linear-gradient(90deg,#1a2a4a,#0f1f38);border-bottom:3px solid #c8102e;padding:9px 16px;display:flex;align-items:center;gap:10px;}
.card-banner .bar{width:4px;height:20px;background:#c8102e;border-radius:2px;}
.card-banner h2{font-size:17px;font-weight:800;letter-spacing:.08em;color:#fff;text-transform:uppercase;}

/* ‚îÄ‚îÄ Card body: left + right ‚îÄ‚îÄ */
.card-body{display:flex;gap:0;padding:18px 18px 14px;}
.card-left{flex:1 1 360px;padding-right:20px;border-right:1px solid #1e3a5f;}
.card-right{flex:0 0 240px;padding-left:20px;}

/* ‚îÄ‚îÄ Player identity row ‚îÄ‚îÄ */
.identity{display:flex;gap:14px;align-items:flex-start;margin-bottom:16px;}
.avatar{width:74px;height:74px;border-radius:8px;background:linear-gradient(135deg,#1e3a5f,#2d4a6f);display:flex;align-items:center;justify-content:center;font-size:32px;flex-shrink:0;border:2px solid #2d4a6f;}
.player-name-block{flex:1;}
.player-name-block .name{font-size:21px;font-weight:800;font-style:italic;letter-spacing:.05em;color:#fff;text-transform:uppercase;line-height:1;}
.player-name-block .sub{font-size:11px;color:#888;margin-top:3px;letter-spacing:.04em;}
.proj-block{text-align:center;flex-shrink:0;}
.proj-label{font-size:9px;color:#aaa;text-transform:uppercase;letter-spacing:.08em;margin-bottom:3px;}
.proj-box{width:70px;height:70px;border-radius:6px;display:flex;align-items:center;justify-content:center;font-size:24px;font-weight:900;color:#fff;font-family:'Oswald',sans-serif;}

/* ‚îÄ‚îÄ Info grid (Pos, Yr, GP, Season) ‚îÄ‚îÄ */
.meta-grid{display:grid;grid-template-columns:auto 1fr auto 1fr;gap:3px 10px;font-size:12px;margin-bottom:16px;padding:10px 12px;background:rgba(255,255,255,.03);border-radius:6px;border:1px solid #1e3a5f;}
.ml{color:#888;}.mv{color:#e2e8f0;font-weight:700;}

/* ‚îÄ‚îÄ Stat boxes (like JFresh row of colored pct tiles) ‚îÄ‚îÄ */
.stat-section-label{font-size:9px;color:#888;text-transform:uppercase;letter-spacing:.1em;margin-bottom:6px;margin-top:12px;}
.stat-boxes{display:flex;gap:6px;flex-wrap:wrap;margin-bottom:4px;}
.stat-tile{flex:1;min-width:58px;text-align:center;}
.tile-label{font-size:9px;color:#aaa;text-transform:uppercase;letter-spacing:.04em;margin-bottom:3px;white-space:nowrap;}
.tile-val{border-radius:5px;padding:9px 4px;font-size:20px;font-weight:900;color:#fff;font-family:'Oswald',sans-serif;display:block;}

/* ‚îÄ‚îÄ Right side: trend chart ‚îÄ‚îÄ */
.chart-title{font-size:11px;font-weight:700;letter-spacing:.08em;text-transform:uppercase;color:#aaa;margin-bottom:6px;}
.chart-wrap{position:relative;height:140px;}

.trend-legend{display:flex;gap:12px;margin-top:8px;flex-wrap:wrap;}
.legend-item{font-size:10px;display:flex;align-items:center;gap:4px;color:#aaa;}
.legend-dot{width:10px;height:10px;border-radius:50%;}

/* season history */
.history-label{font-size:9px;color:#888;text-transform:uppercase;letter-spacing:.08em;margin:14px 0 6px;}
table{width:100%;border-collapse:collapse;font-size:11px;}
th{padding:3px 4px;color:#666;text-align:right;font-weight:600;border-bottom:1px solid #1e3a5f;font-size:10px;}
th:first-child{text-align:left;}
td{padding:4px 4px;text-align:right;border-bottom:1px solid #111827;color:#cbd5e1;}
td:first-child{text-align:left;color:#888;}
.pct-pill{border-radius:3px;padding:1px 5px;font-size:10px;font-weight:700;color:#fff;}

/* ‚îÄ‚îÄ Footer ‚îÄ‚îÄ */
.card-footer{background:#070d18;border-top:1px solid #1e3a5f;padding:7px 16px;display:flex;justify-content:space-between;align-items:center;}
.footer-note{font-size:10px;color:#444;}
.footer-brand{font-size:11px;font-weight:700;color:#1e3a5f;letter-spacing:.1em;}

/* ‚îÄ‚îÄ Empty state ‚îÄ‚îÄ */
.empty{width:100%;max-width:700px;text-align:center;padding:60px 20px;color:#334155;}
.empty-icon{font-size:52px;margin-bottom:12px;}
.empty-title{font-size:18px;font-weight:700;}
.empty-sub{font-size:12px;margin-top:6px;}

/* ‚îÄ‚îÄ Loading ‚îÄ‚îÄ */
#loadingMsg{font-size:13px;color:#60a5fa;padding:14px 18px;background:#111827;border-radius:8px;border:1px solid #1e3a5f;width:100%;max-width:700px;text-align:center;margin-bottom:16px;}
</style>
</head>
<body>

<div class="page-title">
  <div class="bar"></div>
  <div>
    <span>College Hockey Stats ¬∑ 2021‚Äì22 to 2025‚Äì26</span>
    <h1>PLAYER CARDS</h1>
  </div>
</div>

<div id="loadingMsg">‚ö° Loading player data...</div>

<div class="dropdown-row" style="display:none;" id="dropdownWrap">
  <select id="playerSelect">
    <option value="">‚Äî Select a player ‚Äî</option>
  </select>
</div>

<div class="card" id="card">
  <div class="card-wrap">

    <div class="card-banner">
      <div class="bar"></div>
      <h2 id="bannerName"></h2>
    </div>

    <div class="card-body">

      <!-- LEFT -->
      <div class="card-left">

        <div class="identity">
          <div class="avatar">üèí</div>
          <div class="player-name-block">
            <div class="name" id="playerName"></div>
            <div class="sub" id="playerSub"></div>
            <div style="margin-top:8px;">
              <div class="meta-grid" id="metaGrid"></div>
            </div>
          </div>
          <div class="proj-block">
            <div class="proj-label">Pt/Gm Pct</div>
            <div class="proj-box" id="projBox"></div>
          </div>
        </div>

        <div class="stat-section-label">Offensive</div>
        <div class="stat-boxes" id="offBoxes"></div>

        <div class="stat-section-label">Two-Way &amp; Other</div>
        <div class="stat-boxes" id="defBoxes"></div>

        <div style="margin-top:12px;font-size:10px;color:#444;line-height:1.5;">
          Percentile ranked among same position group per season ¬∑ Data: CollegeHockeyInc.com
        </div>
      </div>

      <!-- RIGHT -->
      <div class="card-right">
        <div class="chart-title">Pt/Gm Percentile Trend</div>
        <div class="chart-wrap">
          <canvas id="trendChart"></canvas>
        </div>

        <div class="history-label">Season History</div>
        <table>
          <thead><tr><th>Season</th><th>G</th><th>A</th><th>Pt/Gm</th><th>Pct</th></tr></thead>
          <tbody id="historyBody"></tbody>
        </table>
      </div>

    </div>

    <div class="card-footer">
      <span class="footer-note">Data: CollegeHockeyInc.com ¬∑ Percentile ranked within position + season</span>
      <span class="footer-brand">COLLEGE HOCKEY CARDS</span>
    </div>
  </div>
</div>

<div class="empty" id="emptyState" style="display:none;">
  <div class="empty-icon">üèí</div>
  <div class="empty-title">Select a player to view their card</div>
  <div class="empty-sub" id="playerCount"></div>
</div>

<script>
var nameIndex = {}, allNames = [], trendChart = null;

fetch("hockey_data.json")
  .then(function(r){ if(!r.ok) throw new Error("HTTP "+r.status); return r.json(); })
  .then(function(data){
    data.forEach(function(row){
      if(!nameIndex[row.Name]) nameIndex[row.Name]=[];
      nameIndex[row.Name].push(row);
    });
    allNames = Object.keys(nameIndex).sort();

    var sel = document.getElementById("playerSelect");
    allNames.forEach(function(n){
      var opt = document.createElement("option");
      opt.value = n; opt.textContent = n;
      sel.appendChild(opt);
    });

    document.getElementById("loadingMsg").style.display = "none";
    document.getElementById("dropdownWrap").style.display = "block";
    document.getElementById("emptyState").style.display = "block";
    document.getElementById("playerCount").textContent =
      allNames.length.toLocaleString() + " players ¬∑ 2021-22 through 2025-26";
  })
  .catch(function(err){
    document.getElementById("loadingMsg").textContent =
      "‚ö†Ô∏è Could not load hockey_data.json ‚Äî make sure it's in the same folder. (" + err.message + ")";
    document.getElementById("loadingMsg").style.color = "#f87171";
  });

document.getElementById("playerSelect").addEventListener("change", function(){
  var name = this.value;
  if(!name){ 
    document.getElementById("card").style.display = "none";
    document.getElementById("emptyState").style.display = "block";
    return;
  }
  showPlayer(name);
});

function pctColor(v){
  if(v==null) return "#2a2a2a";
  if(v>=90) return "#1565c0";
  if(v>=75) return "#1976d2";
  if(v>=50) return "#7b1fa2";
  if(v>=25) return "#6a1a1a";
  return "#2a2a2a";
}
function pctFmt(v){ return (v==null) ? "N/A" : Math.round(v)+"%"; }
function numFmt(v,d){ return (v==null) ? "‚Äî" : Number(v).toFixed(d||0); }

function tile(label, val){
  return '<div class="stat-tile">' +
    '<div class="tile-label">'+label+'</div>' +
    '<span class="tile-val" style="background:'+pctColor(val)+'">'+pctFmt(val)+'</span>' +
    '</div>';
}

function showPlayer(name){
  var rows = (nameIndex[name]||[]).slice().sort(function(a,b){ return a.Season.localeCompare(b.Season); });
  if(!rows.length) return;
  var cur = rows[rows.length-1];

  document.getElementById("emptyState").style.display = "none";
  document.getElementById("card").style.display = "block";

  document.getElementById("bannerName").textContent = name.toUpperCase();
  document.getElementById("playerName").textContent = name.toUpperCase();
  document.getElementById("playerSub").textContent =
    (cur.Team||"") + " ¬∑ " + (cur.Pos_Group||"") + " ¬∑ " + (cur.Season||"");

  document.getElementById("metaGrid").innerHTML =
    '<span class="ml">Pos</span><span class="mv">'+(cur.Pos_Group||"‚Äî")+'</span>' +
    '<span class="ml">Year</span><span class="mv">'+(cur.Yr||"‚Äî")+'</span>' +
    '<span class="ml">GP</span><span class="mv">'+numFmt(cur.GP)+'</span>' +
    '<span class="ml">Season</span><span class="mv">'+(cur.Season||"‚Äî")+'</span>';

  var pb = document.getElementById("projBox");
  pb.textContent = pctFmt(cur.PtGm_pct);
  pb.style.background = pctColor(cur.PtGm_pct);

  document.getElementById("offBoxes").innerHTML =
    tile("Pt/Gm", cur.PtGm_pct) +
    tile("Goals", cur.G_pct) +
    tile("Assists", cur.A_pct) +
    tile("Shots", cur.Shots_pct) +
    tile("PPG", cur.PPG_pct);

  document.getElementById("defBoxes").innerHTML =
    tile("SHG", cur.SHG_pct) +
    tile("+/-", cur["+/-_pct"]) +
    tile("Blocks", cur.Blk_pct) +
    tile("FO%", cur.FO_pct);

  // Trend chart
  var seasons = rows.map(function(r){ return r.Season; });
  var pcts    = rows.map(function(r){ return r.PtGm_pct; });
  var gPcts   = rows.map(function(r){ return r.G_pct; });
  var aPcts   = rows.map(function(r){ return r.A_pct; });

  var ctx = document.getElementById("trendChart").getContext("2d");
  if(trendChart) trendChart.destroy();
  trendChart = new Chart(ctx, {
    type: "line",
    data: {
      labels: seasons,
      datasets: [
        { label:"Pt/Gm", data:pcts,  borderColor:"#60a5fa", backgroundColor:"rgba(96,165,250,0.08)", borderWidth:2.5, pointBackgroundColor:"#60a5fa", pointRadius:4, tension:0.3, fill:true },
        { label:"Goals", data:gPcts, borderColor:"#f87171", backgroundColor:"transparent",            borderWidth:1.5, pointBackgroundColor:"#f87171", pointRadius:3, tension:0.3 },
        { label:"Assists",data:aPcts,borderColor:"#a78bfa", backgroundColor:"transparent",            borderWidth:1.5, pointBackgroundColor:"#a78bfa", pointRadius:3, tension:0.3, borderDash:[4,3] }
      ]
    },
    options:{
      responsive:true, maintainAspectRatio:false,
      plugins:{
        legend:{display:true, position:"bottom", labels:{color:"#888",font:{size:10},boxWidth:10,padding:8}},
        tooltip:{callbacks:{label:function(c){ return c.dataset.label+": "+Math.round(c.parsed.y)+"%"; }}}
      },
      scales:{
        y:{min:0,max:100,ticks:{color:"#666",font:{size:9},stepSize:25},grid:{color:"#111827"}},
        x:{ticks:{color:"#666",font:{size:9}},grid:{color:"#111827"}}
      }
    }
  });

  // History table
  document.getElementById("historyBody").innerHTML = rows.map(function(r){
    return "<tr><td>"+r.Season+"</td>" +
      "<td>"+numFmt(r.G)+"</td>" +
      "<td>"+numFmt(r.A)+"</td>" +
      "<td>"+numFmt(r["Pt/Gm"],2)+"</td>" +
      '<td><span class="pct-pill" style="background:'+pctColor(r.PtGm_pct)+'">'+pctFmt(r.PtGm_pct)+"</span></td></tr>";
  }).join("");
}
</script>
</body>
</html>
